<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>bpmn-js properties panel demo</title>

  <link rel="stylesheet" href="vendor/bpmn-js/assets/diagram-js.css" />
  <link rel="stylesheet" href="vendor/bpmn-js/assets/bpmn-js.css" />
  <link rel="stylesheet" href="vendor/bpmn-js/assets/bpmn-font/css/bpmn-embedded.css" />
  <link rel="stylesheet" href="vendor/bpmn-js-properties-panel/assets/properties-panel.css" />

  <link rel="stylesheet" href="app.css" />
</head>

<body>
  <div class="content with-diagram" id="js-drop-zone">

    <div class="message intro">
      <div class="note">
        Drop BPMN diagram from your desktop or <a id="js-create-diagram" href>create a new diagram</a> to get started.
      </div>
    </div>

    <div class="message error">
      <div class="note">
        <p>Ooops, we could not display the BPMN 2.0 diagram.</p>

        <div class="details">
          <span>Import Error Details</span>
          <pre></pre>
        </div>
      </div>
    </div>

    <div class="canvas" id="js-canvas"></div>
    <div class="properties-panel-parent" id="js-properties-panel"></div>
  </div>

  <ul class="buttons">
    <li>
      download
    </li>
    <li>
      <a id="js-download-diagram" href title="download BPMN diagram">
        BPMN diagram
      </a>
    </li>
    <li>
      <a id="js-download-svg" href title="download as SVG image">
        SVG image
      </a>
    </li>
    <li>
      <a id="data-getter" href title="download as SVG image">
        get xml
      </a>
    </li>
    <li>
      <a id="data-input" href title="download as SVG image">
        upload from thymeleaf
      </a>
    </li>
  </ul>

</body>
<script src="app.js">


</script>
<script>
  const xmlData = `<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd">
  <bpmn2:process id="Process_1" isExecutable="false">
    <bpmn2:startEvent id="StartEvent_1" />
    <bpmn2:task id="Activity_1ynwuc6" />
    <bpmn2:endEvent id="Event_0s0fuzr" />
    <bpmn2:intermediateThrowEvent id="Event_0xfsdat" />
    <bpmn2:startEvent id="Event_19n9got" />
    <bpmn2:startEvent id="Event_0b152c9" />
    <bpmn2:group id="Group_1fgw3vd" />
  </bpmn2:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="412" y="240" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1ynwuc6_di" bpmnElement="Activity_1ynwuc6">
        <dc:Bounds x="440" y="410" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0s0fuzr_di" bpmnElement="Event_0s0fuzr">
        <dc:Bounds x="792" y="302" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0xfsdat_di" bpmnElement="Event_0xfsdat">
        <dc:Bounds x="312" y="240" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_19n9got_di" bpmnElement="Event_19n9got">
        <dc:Bounds x="212" y="482" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0b152c9_di" bpmnElement="Event_0b152c9">
        <dc:Bounds x="502" y="632" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Group_1fgw3vd_di" bpmnElement="Group_1fgw3vd">
        <dc:Bounds x="420" y="560" width="300" height="300" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>
`
  document.getElementById('data-getter').addEventListener('click', function () {
    // Verifica si la instancia de bpmnModeler está disponible
    if (window.bpmnModeler) {
      getData()

    } else {
      console.error('La instancia de bpmnModeler no está disponible');
    }
  });
  document.getElementById('data-input').addEventListener('click', function () {
    if (window.bpmnModeler) {
      openDiagram(xmlData)
      console.log(xmlData, window.bpmnModeler);
    } else {
      console.error('La instancia de bpmnModeler no está disponible');
    }
  });

  async function openDiagram(xml) {
    try {
      await bpmnModeler.importXML(xml);

    } catch (err) {


      console.error(err);
    }
  }
  async function getData() {
    try {
      const { xml } = await bpmnModeler.saveXML({ format: true });
      console.log(xml)

    } catch (err) {
      console.log("Error happened saving XML: ", err);
    }
  }



</script>

</html>