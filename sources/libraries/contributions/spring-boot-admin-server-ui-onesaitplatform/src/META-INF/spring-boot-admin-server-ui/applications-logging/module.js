webpackJsonp([9],{0:function(e,n,t){(function(e){"use strict";var n=t(1),r=n.module("sba-applications-logging",["sba-applications-jmx"]);e.sbaModules.push(r.name),r.service("ApplicationLogging",t(113)),r.controller("loggingCtrl",t(112)),r.component("sbaLogger",t(111)),r.config(["$stateProvider",function(e){e.state("applications.logging",{url:"/logging",templateUrl:"applications-logging/views/logging.html",controller:"loggingCtrl"})}]),r.run(["ApplicationViews","$sce","$http",function(e,n,t){e.register({order:30,title:n.trustAsHtml('<i class="fa fa-sliders fa-fw"></i>Logging'),state:"applications.logging",show:function(e){return t.head("api/applications/"+e.id+"/loggers").then(function(){return!0}).catch(function(){return t.head("api/applications/"+e.id+"/jolokia").then(function(){return!0}).catch(function(){return!1})})}})}])}).call(n,function(){return this}())},111:function(e,n,t){"use strict";e.exports={bindings:{logger:"<value",levelchangeCallback:"&onLevelChanged"},controller:function(){var e=this;e.getLoggerClass=function(n){if(e.logger.level!==n)return"";switch(e.logger.level){case"TRACE":return"active btn-danger";case"DEBUG":return"active btn-warning";case"INFO":return"active btn-info";case"WARN":return"active btn-success";case"ERROR":return"active btn-primary";case"OFF":return"active btn-inverse";default:return""}},e.setLevel=function(n){e.logger.setLevel(n).finally(function(){e.levelchangeCallback()(e.logger,n)})}},template:t(156)}},112:function(e,n,t){"use strict";var r=t(1);e.exports=["$scope","application","ApplicationLogging",function(e,n,t){"ngInject";e.loggers=[],e.filteredLoggers=[],e.limit=10,e.error=null,e.showPackageLoggers=!1,e.packageFilter=function(n){return!n.packageLogger||e.showPackageLoggers},e.togglePackageLoggers=function(){e.showPackageLoggers=!e.showPackageLoggers};var o=function(e,t,r){this.name=e,this.level=t.configuredLevel||t.effectiveLevel,this.levels=r;var o=e.lastIndexOf(".")+1;this.packageLogger=e.charAt(o)!==e.charAt(o).toUpperCase(),this.setLevel=function(t){return n.setLoggerLevel(e,t)}};e.refreshLoggers=function(){return n.getLoggers().then(function(n){e.error=null;var t=[],i=n.data.levels.reverse();r.forEach(n.data.loggers,function(e,n){t.push(new o(n,e,i))}),e.loggers=t}).catch(function(n){e.error=n})},e.refreshLoggers().then(function(){null!=e.error&&404===e.error.status&&(e.error=null,i())});var i=function(){t.getLoggingConfigurator(n).then(function(n){e.refreshLoggers=function(t){var r=e.loggers.filter(function(e){return!t||"ROOT"===t.name||0===e.name.indexOf(t.name)});n.getLogLevels(r).catch(function(n){n.some(function(n){return null!==n.error&&(e.error=n,!0)})})},n.getAllLoggers().then(function(n){e.loggers=n}).catch(function(n){e.error=n})}).catch(function(n){e.error=n})}}]},113:function(e,n){"use strict";e.exports=["$q","jolokia",function(e,n){"ngInject";var t=function(e,n){return e.find(function(e){var t=/ch.qos.logback.classic:Name=([^,]+)/.exec(e);return null!==t&&t[1].toUpperCase()===n.toUpperCase()})},r=function(r){return n.search("api/applications/"+r.id+"/jolokia/","ch.qos.logback.classic:Name=*,Type=ch.qos.logback.classic.jmx.JMXConfigurator").then(function(n){if(1===n.value.length)return n.value[0];if(n.value.length>1){var o=t(n.value,r.name);return void 0===o&&(o=t(n.value,"default")),void 0===o?e.reject({error:"Ambigious Logback JMXConfigurator-MBeans found!",candidates:n.value}):o}return e.reject({error:"Couldn't find Logback JMXConfigurator-MBean"})})};this.getLoggingConfigurator=function(t){var o=function(r){var o=this,i=function(e){this.name=e,this.level=null,this.levels=["TRACE","DEBUG","WARN","INFO","ERROR","OFF"];var o=e.lastIndexOf(".")+1;this.packageLogger=e.charAt(o)!==e.charAt(o).toUpperCase(),this.setLevel=function(o){return n.exec("api/applications/"+t.id+"/jolokia/",r,"setLoggerLevel",[e,o])}};this.getLogLevels=function(o){if(0===o.length){var i=e.defer();return i.resolve(!0),i.promise}var a=o.map(function(e){return{type:"exec",mbean:r,operation:"getLoggerEffectiveLevel",arguments:[e.name]}});return n.bulkRequest("api/applications/"+t.id+"/jolokia/",a).then(function(e){return e.forEach(function(e){var n=o.find(function(n){return n.name===e.request.arguments[0]});n&&(n.level=e.value)}),!0})},this.getAllLoggers=function(){return n.readAttr("api/applications/"+t.id+"/jolokia/",r,"LoggerList").then(function(e){return e.value.map(function(e){return new i(e)})}).then(function(n){return o.getLogLevels(n).then(function(){return n}).catch(function(n){e.reject(n)})})}};return r(t).then(function(e){return new o(e)})}}]},156:function(e,n){e.exports='{{ $ctrl.logger.name }}\n<div class="btn-group pull-right">\n  <button ng-repeat="level in $ctrl.logger.levels" class="btn btn-small" ng-class="$ctrl.getLoggerClass(level)" ng-click="$ctrl.setLevel(level)"\n    ng-bind="level"></button>\n</div>'}});