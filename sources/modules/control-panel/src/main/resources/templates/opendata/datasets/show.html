<!--

    Copyright Indra Soluciones Tecnologías de la Información, S.L.U.
    2013-2022 SPAIN

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
         http://www.apache.org/licenses/LICENSE-2.0
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<html xmlns:th="http://www.thymeleaf.org"  th:with="lang=${#locale.language}" th:lang="${lang}">
	<head>
		<meta name="_csrf" th:content="${_csrf.token}"/>
		<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
		<meta http-equiv="Content-Language" th:content="${lang}"/>
		<title th:text="#{name.app}"/>

		<!-- STYLE SHEETS -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/bootstrap.min.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/components.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/plugins.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/layout.css}"/>
		<!-- THEME -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/webjars/sofia2_theme/css/sofia2.css}"/>
		
		<!-- PLUGINS -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/datatable/datatables.bootstrap.css}"/>
        <link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/bootstrap-markdown/bootstrap-markdown.min.css}"/>
		
	</head>	
	
	<!-- page-sidebar-closed to START WITH MENU COLLAPSED. -->
	<body class="page-header-fixed  page-content-white page-sidebar-closed">

	<!-- MAIN PAGE WRAPPER -->
	<div class="page-wrapper">
	
		<!-- BEGIN HEADER INCLUDE -->
		<div th:include="fragments/header::#headerFragment" class="page-header navbar navbar-fixed-top"></div>
		<!-- END HEADER -->
		
		<!-- HEADER AND CONTENT DIVIDER -->
		<div class="clearfix"> </div>
			
		<!-- BEGIN SIDEBAR INCLUDE (MENU) -->
		<div th:include="fragments/menu::#menuFragment" class="page-sidebar-wrapper"></div>
		<!-- END SIDEBAR -->
			
		<!-- BEGIN CONTENT -->
		<div class="page-content-wrapper">
			
			<!-- BEGIN CONTENT BODY -->
			<div class="page-content">
			
				<div class="alert alert-success display-hide">
					<span th:text="${globalMessage}"></span>
				</div>		
				
				<!-- BEGIN PAGE BAR AND BREADCRUM-->
				<div class="page-bar margin-bottom-20">
					<ul class="page-breadcrumb">
						<li><a th:href="@{/opendata/datasets/list}"> <span th:text="#{datasets.breadcrumb.list}">Datasets</span></a><i class="fa fa-angle-right"></i></li>
						<li>
							<span th:text="#{datasets.breadcrumb.show}">Show Dataset</span>	
						</li>
					</ul>						
				</div>
				<!-- END PAGE BAR -->
				
				<!-- BEGIN PAGE TITLE-->
				<h1 class="page-title hide "><span th:text="#{name.app}"> Onesaitplatform Control Panel</span></h1>
				<!-- END PAGE TITLE-->			
				
				<!-- AUXILIAR FORM TO DELETE DATAMODEL -->										
				<form id="delete_dataset_form" class="delete-dataset hide"  action=""  method="post">
					<input type="hidden" name="_method" value="DELETE"/>
					<input type="hidden" name="id" th:value="${dataset?.id}"/>
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
				</form>
				<!-- AUXILIAR FORM TO DELETE RESOURCE -->
                <form id="delete_resource_form" class="delete-resource hide" method="post">
                    <input type="hidden" name="_method" value="DELETE"/>
                    <input type="hidden" id="delete-id" name="id"/>
                	<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            	</form>
                <!-- AUXILIAR FORM TO DOWNLOAD RESOURCE -->
                <form id="download_resource_form" class="download-resource hide">
                    <input type="hidden" id="download-format" name="format"/>
                </form>
                
				<form role="form" id="dataset_view_form" action="show.html" th:object="${dataset}" method="post" class="form">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
					<div id="header">
						<div class="row pageCreateHeader">
							<div class="col-md-6 col-sm-6 col-xs-12">
								<div class="margin-top-4">
									<span class="caption-subject " th:text="${dataset.title}"> Show Dataset</span>
								</div>
							</div>
							
							<div class="col-md-6 col-sm-6 col-xs-12">
								<div class="pull-right">
									<!-- DELETE -->
									<button th:if="${dataset.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" id="deleteBtn" type="button" class="btn btn-primary btn-primary-delete" name="delete"  value="Remove" th:attr="onclick='deleteDatasetConfirmation(\'' + ${dataset.id} + '\');'" ><i class="icon-delete"></i><span th:text="#{gen.deleteBtn}" class="delete-btn-text"> Delete </span></button>
									<span th:if="${dataset.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" class="sep"></span>	
										
									<!-- CANCEL -->											
									<button id="cancelBtn" type="button" class="btn btn-primary-cancel" name="cancel"  th:value="#{gen.cancelBtn}" value="cancel" th:attr="onclick='javascript:navigateUrl(\'' + @{/opendata/datasets/list} + '\');'"><span th:text="#{gen.cancelBtn}"> Cancel </span></button>
									<span th:if="${dataset.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" class="sep no-border"></span>
	
									<!-- UPDATE -->								
									<button th:if="${dataset.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" id="editBtn" type="button" class="btn btn-primary btn-primary-save" name="edit"  value="Edit" th:attr="onclick='javascript:navigateUrl(\'' + @{|/opendata/datasets/update/${dataset.id}/|} + '\');'" > <span th:text="#{gen.editBtn}"> Edit </span></button>
	
								</div>
							</div>
						</div>
					</div>
				
					<!-- MAIN ROW -->
					<div class="mainPanel">	
						<div class="row main">
						    <div class="col-md-12 panelHeader">
						        <span th:text="#{gen.generalInformation}">General Information</span>
						    </div>
           				</div>
                        
						<!-- dataset, name, labels-->
						<div class="row main">											
		                    <div class="col-md-5 col-sm-6 col-xs-12">
		                        <div class="form-group ">
									<label class="control-label" th:text="#{datasets.name} ">Name</label>
									<p id="viewName" name="viewName" class="form-control-static-block " th:text="*{title}"> Dataset Name </p>
								</div>
							</div>
							<div class="col-md-5 col-sm-6 col-xs-12">
								<div class="form-group">
									<label class="control-label" th:text="#{datasets.tags} ">Tags</label>
									<p id="viewTags" name="viewTags" class="form-control-static-block " th:text="${#strings.listJoin(dataset.tags,',')}"> Dataset tags </p>
								</div>
							</div>
                            <div class="col-md-2 col-sm-6 col-xs-12">
                            	<div class="form-group">
									<label class="control-label" th:text="#{datasets.public} + '?'">Public</label>
									<p class="form-control-static-block static-blank ">
										<span th:if="*{isPublic}"><i class="la la-check-circle-o text-success font-hg"></i></span>
										<span th:if="!*{isPublic}"><i class="la la-times-circle-o text-danger font-hg"></i></span>
									</p>
								</div>
							</div>
						</div>							

						<div class="row main">								
							<div class="col-md-4 col-sm-12 col-xs-12">
								<div class="form-group">
	  	       	                	<label class="control-label" th:text="#{datasets.typology} ">Typology</label>
									<p id="datasetTypology" name="datasetTypology" class="form-control-static-block " th:text="*{typology}"> Dataset Typology </p>
								</div>
							</div>
                            <div class="col-md-4 col-sm-6 col-xs-12">
                            	<div class="form-group">
									<label class="control-label" th:text="#{datasets.organization} "> Organization </label>
									<p id="viewOrganization" name="viewOrganization" class="form-control-static-block " th:text="*{organization} "> Dataset Organization </p>
								</div>
							</div>
                            <div class="col-md-4 col-sm-6 col-xs-12">
                            	<div class="form-group ">							
									<label class="control-label" th:text="#{datasets.license} ">License </label>
									<p id="viewLicense" name="viewLicense" class="form-control-static-block " th:text="*{license} "> Dataset License </p>
								</div>
							</div>	
						</div>
						
						<div class="row main border-bottom">								
					    	<div class="col-md-6 col-sm-12 col-xs-12">
                            	<div class="form-group">
									<label class="control-label" th:text="#{datasets.description}"> Description </label>		
									<textarea class="element textarea small form-control" id="description" data-provide="markdown" th:text="*{description}" data-iconlibrary="fa" rows="15" name="description" style="border: none;padding: 10px"></textarea>
								</div>
							</div>												
						</div>
                        
                        <div class="row main border-bottom">
                        	<!-- FILES LIST -->
							<div id="filesList" class="col-md-12" style="margin-top:20px">			
								<span class="panelSubHeader" th:text="#{datasets.binaryfiles}"> Binary Files</span>									
	                            <div class="caption" style="padding: 8px 8px 8px 10px;display: inline-block;">
			                        <a onclick="$('.files-search-icon').toggleClass('hide')" class="files-search-icon" style="margin-left: 18px;"><i class="icon-search"></i></a>
			                    </div>
			                    <div id="files-search-on-title" class="hide input-icon files-search-icon" style="padding: 0;display: inline-block;">
			                        <a class ="input-icon" onclick="$('.files-search-icon').toggleClass('hide')"><i class="icon-search"></i></a>
			                    </div>				
								<div id="contenedor-tabla-outside" class="contiene" style="margin-top:25px">																						
									<!-- DATATABLE DANDELION CONF. -->												
									<table id="files" class="table table-hover table-striped" dt:table="true" dt:paginationtype="full">
										<thead>
											<tr class="cabecera-tabla">
												<th class="titulo-columnas text-left"><span th:text="#{binaryfiles.filename}"> filename </span></th>
												<th class="titulo-columnas text-center" dt:sortable="false" style="width:85px;"><span th:text="#{gen.options}"> Options</span></th>
											</tr>
										</thead>
										<tbody th:remove="all-but-first">
											<tr th:each="file : ${binaryFiles}" pages:paginate="10">
												<!-- File name -->
												<td class="text-left bold no-wrap" th:text="${file.fileName}"></td>
												<!-- OPTIONS -->
												<td class="icon text-center" style="text-align: center; white-space: nowrap">
													<!-- DOWNLOAD -->	
													<span class="btn btn-xs btn-no-border icon-on-table color-blue tooltips" data-container="body" data-placement="bottom" th:title="#{binaryfiles.download}" th:data-original-title="#{binaryfiles.download}" th:attr="onclick='getBinaryFile(\''+${file.id}+'\')'"><i class="icon-download"> </i></span>
													<!-- Copy link, accesible always -->
													<span class="btn btn-xs btn-no-border icon-on-table color-blue tooltips" data-container="body" data-placement="bottom" th:title="#{binaryfiles.copy}" th:data-original-title="#{binaryfiles.copy}" th:attr="onclick='copyToClipboard(\''+|@{/files/}|+${file.id}+ '\')'"><i class="icon-url"> </i></span>			
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>  
						
						
						<div class="row main border-bottom">
							<!-- RESOURCES LIST -->
							<div id="resourcesList" class="col-md-12" style="margin-top:20px">
								<span class="panelSubHeader" th:text="#{datasets.resources.list}"> Resources </span>
								<div class="caption" style="padding: 8px 8px 8px 10px;display: inline-block;">
			                        <a onclick="$('.resources-search-icon').toggleClass('hide')" class="resources-search-icon" style="margin-left: 18px;"><i class="icon-search"></i></a>
			                    </div>
			                    <div id="resources-search-on-title" class="hide input-icon resources-search-icon" style="padding: 0;display: inline-block;">
			                        <a class ="input-icon" onclick="$('.resources-search-icon').toggleClass('hide')"><i class="icon-search"></i></a>
			                    </div>
		                        <div id="contenedor-tabla-outside" class="contiene" style="margin-top:25px"> 
	                                <!-- DATATABLE DANDELION CONF.  -->     
	                                <table id="resources" class="table table-hover table-striped" dt:table="true" dt:paginationtype="full">
	                                    <thead>
	                                        <tr class="cabecera-tabla">
	                                            <th class="titulo-columnas" th:text="#{resources.name}">Name</th>
	                                            <th class="titulo-columnas text-left" th:text="#{resources.format}">Format</th>
	                                            <th class="titulo-columnas text-left"> <span th:text="#{resources.ontology}" >Ontology</span></th>
	                                            <th class="titulo-columnas text-center" dt:sortable="false" style="width:85px;"><span th:text="#{gen.options}"> Options</span></th>
	                                        </tr>
	                                    </thead>
	                                    <tbody th:remove="all-but-first">
	                                        <tr th:each="resource : ${resourcesList}" pages:paginate="10">
	                                            <!-- NAME -->
	                                            <td class="text-left no-wrap " th:text="${resource.name}"></td>
	                                            <!-- FORMAT -->
	                                            <td class="text-left" th:text="${resource.format}"></td>
	                                            <!-- ONTOLOGY -->
	                                            <td class="text-left" th:text="${resource.ontology}"></td>
	                                            <!-- OPTIONS -->
	                                            <td class="icon text-center" style="white-space: nowrap">
	                                                <div class="grupo-iconos dropdown" th:with="rolesList = ${new java.lang.String[]{'admin','editor'}}">
	                                                    <!-- VIEW -->                
	                                                    <span  th:title="#{gen.view}" class="btn btn-xs btn-no-border icon-on-table color-blue tooltips" data-container="body" data-placement="bottom" th:data-original-title="#{gen.view}" th:attr="onclick='javascript:navigateUrl(\'' + @{|/opendata/resources/show/${resource.id}/|} + '\');'"><i class="la la-eye font-hg"></i></span>

														<!-- DOWNLOAD -->
                                                      	<span th:if="!${resource.datastore}" id="downloadBtn1" class="btn btn-xs btn-no-border icon-on-table color-blue tooltips" data-container="body" data-placement="bottom" th:title="#{resources.download} " th:data-original-title="#{resources.download} ">
                                                      		<i class="icon-download" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.format} + '\',\'other\');'" > </i>
                                                      	</span> 
                                                      	<span class="dropdown"> 
	                                                      	<span th:if="${resource.datastore}" class="btn btn-xs btn-no-border icon-on-table color-blue tooltips" data-container="body" data-placement="bottom" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
	                                                        <i class="icon-download"> </i></span>
	                                                        <ul class="dropdown-menu dropdown-menu-table download-menu">
	                                                          	<li>
	                                                              	<a class="dropdown-item uppercase" th:text="#{resources.csv}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">CSV</a>
	                                                          	</li>
	                                                          	<li>
	                                                              	<a class="dropdown-item uppercase" th:text="#{resources.tsv}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">TSV</a>
	                                                          	</li>
	                                                          	<li>
	                                                              	<a class="dropdown-item uppercase" th:text="#{resources.json}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">JSON</a>
	                                                          	</li>
	                                                          	<li>
	                                                              	<a class="dropdown-item uppercase" th:text="#{resources.xml}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">XML</a>
	                                                          	</li>
	                                                        </ul>
                                                    	</span>
                                                    	
	                                                    <th:block  th:if="${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR' OR ${#lists.contains(rolesList, resource.role)}">
		                                                    <span id="options-dropdown" class="dropdown">
																<span   class="btn btn-xs btn-no-border color-blue icon-on-table" data-container="body" data-placement="bottom" data-toggle="dropdown" data-hover="dropdown" data-close-others="true" ><i class="icon-overflow"></i></span>
																<ul class="dropdown-menu dropdown-menu-table download-menu">
																	<li>
					                                                    <!-- EDIT -->
					                                                    <span  th:if="${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR' OR ${#lists.contains(rolesList, resource.role)}" class="btn btn-xs btn-no-border btn-circle btn-outline color-blue" data-container="body" data-placement="bottom" th:title="#{gen.edit}" th:data-original-title="#{gen.edit}" th:attr="onclick='javascript:navigateUrl(\'' + @{|/opendata/resources/update/${resource.id}/|} + '\');'"><i class="icon-edit"></i><span class="span-title-three-dots-icons" th:text="#{gen.editBtn}" >Edit</span></span>
					                                                    <span  th:if="!(${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR' OR ${#lists.contains(rolesList, resource.role)})" class="btn btn-xs btn-no-border btn-circle btn-outline color-blue" data-container="body" data-placement="bottom" disabled th:title="#{gen.edit}" th:data-original-title="#{gen.edit}"><i class="icon-edit"></i><span class="span-title-three-dots-icons" th:text="#{gen.editBtn}" >Edit</span></span>
																	</li>
																	<li>
																		<!-- DELETE -->
				                                                    	<span th:if="${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR' OR ${#lists.contains(rolesList, resource.role)}" class="btn btn-xs btn-no-border btn-circle btn-outline color-red" data-container="body" data-placement="bottom" th:attr="onclick='deleteResource(\'' + ${resource.id} + '\');'"><i class="icon-delete"></i><span class="span-title-three-dots-icons" th:text="#{gen.deleteBtn}" >Delete</span></span>
																	</li>
																</ul>
															</span>
														</th:block>
														
														<th:block  th:if="!(${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR' OR ${#lists.contains(rolesList, resource.role)})">
		                                                    <!-- DOWNLOAD -->
		                                                    <span th:if="!${resource.datastore}" id="downloadBtn1" class="btn btn-xs btn-no-border icon-on-table color-blue" data-container="body" data-placement="bottom">
		                                                    	<i class="icon-download" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.format} + '\',\'other\');'"> </i> 
		                                                    </span>
		                                                    
		                                                    <span class="dropdown">  
			                                                    <span th:if="${resource.datastore}" class="btn btn-xs btn-no-border icon-on-table color-blue downloadBtn2" data-container="body" data-placement="bottom" data-toggle="dropdown" data-hover="dropdown" data-close-others="true"><i class="icon-download"> </i></span>
			                                                    <ul class="dropdown-menu dropdown-menu-table download-menu-download">
			                                                        <li>
			                                                            <a class="dropdown-item uppercase" th:text="#{resources.csv}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">CSV</a>
			                                                        </li>
			                                                        <li>
			                                                            <a class="dropdown-item uppercase" th:text="#{resources.tsv}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">TSV</a>
			                                                        </li>
			                                                        <li>
			                                                            <a class="dropdown-item uppercase" th:text="#{resources.json}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">JSON</a>
			                                                        </li>
			                                                        <li>
			                                                            <a class="dropdown-item uppercase" th:text="#{resources.xml}" th:attr="onclick='downloadResource(\'' + ${resource.id} + '\',\'' + ${resource.url} + '\',\'' + ${resource.url} + '\',this.text);'">XML</a>
			                                                        </li>
			                                                	</ul>
		                                                  	</span>
		                                                  	
		                                                   	<!-- DELETE -->
	    	                                            	<span th:if="${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR' OR ${#lists.contains(rolesList, resource.role)}" class="btn btn-xs btn-no-border icon-on-table color-red" data-container="body" data-placement="bottom" th:attr="onclick='deleteResource(\'' + ${resource.id} + '\');'"><i class="icon-delete"></i></span>
														</th:block>	
	                                                </div>
	                                            </td>
											</tr>
										</tbody>
									</table>                                               
								</div>
							</div>
						</div>						
					</div>
				</form>
			
			</div><!-- END CONTENT BODY -->
		</div><!-- END CONTENT page-content-wrapper -->		
	</div><!-- END MAIN PAGE WRAPPER -->
	
	<!-- FOOTER INCLUDE -->
	<footer th:include="fragments/footer::#footerFragment" class="page-footer"> </footer>
	
	<!-- CORE JS CONTROLLERS -->
	<script th:src="@{/static/js/app.js}"></script>
	<script th:src="@{/static/js/layout.js}"></script>

	<!-- PLUGINS -->

	<script th:src="@{/static/vendor/jquery/jquery.dataTables.min.js}"></script>
	<script th:src="@{/static/vendor/jquery-validation/jquery.validate.js}"></script>
	<script th:src="@{/static/vendor/jquery-validation/jquery.validate.min.js}"></script>
	<script th:src="@{/static/vendor/datatable/datatables.bootstrap.js}"></script>	
	<script th:src="@{/static/vendor/datatable/features/filtering/jquery.dataTables.yadcf.js}"></script>
	<script th:src="@{/static/vendor/bootstrap-select/bootstrap-select.min.js}"></script>-->

	<!-- MARKDOWN -->
    <script th:src="@{/static/vendor/bootstrap-markdown/markdown.js}" type="text/javascript"></script>
    <script th:src="@{/static/vendor/bootstrap-markdown/bootstrap-markdown.js}" type="text/javascript"></script>
    
    <!-- MARKDOWN LOADING DEFAULT LANG MESSAGES IF NEEDED -->
    <script th:if="${lang} == 'es'" th:src="@{/static/vendor/bootstrap-markdown/locale/bootstrap-markdown.es.js}" type="text/javascript"></script>
    
	 <!-- MAIN INIT -->
	<script  th:inline="javascript">
	var showLog = 1; // console.log toggle
	var deleteUrl =  [[@{/opendata/resources/delete}]];
    var downloadUrl = [[@{/opendata/resources/download}]];

    // DATATABLES LANGUAGE FROM PROPERTIES.
    datatable_lang = [[#{datatables_lang}]];    
    var languageJson = JSON.parse(datatable_lang);
    if ( languageJson ){ $.extend( true, $.fn.dataTable.defaults, { language: languageJson }); }

    //<![CDATA[ 
	// REDIRECT
	function navigateUrl(url){  window.location.href = url;	}
	
	// DELETE Dataset 
	function deleteDatasetConfirmation(datasetId){
		console.log('deleteDatasetConfirmation() -> formId: '+ datasetId);
		
		
		// set action and datasetId to the form
		$('.delete-dataset').attr('id',datasetId);
		$('.delete-dataset').attr('action','/controlpanel/opendata/datasets/delete/' + datasetId);
		console.log('deleteUserConfirmation() -> formAction: ' + $('.delete-dataset').attr('action') + ' ID: ' + $('.delete-dataset').attr('id'));
		
		// call Dataset Confirm at header.
		HeaderController.showDatasetConfirmDialog(datasetId);	
	}

	// DELETE RESOURCE
    var deleteResource = function(resourceId){
        console.log('deleteResourceConfirmation() -> formId: '+ resourceId);
        
        
        $('#delete_resource_form').attr('action', deleteUrl + '/' + resourceId);
        $('#delete-id').val(resourceId);

        // call resource Confirm at header.
        HeaderController.showResourceConfirmDialog('delete_resource_form');
    }

    // DOWNLOAD RESOURCE
    var downloadResource = function(resourceId,resourceUrl,resourceFormat,format){
        if ((resourceFormat.toUpperCase() == 'HTML' || resourceFormat.toUpperCase() == 'OPENAPI-JSON') && resourceUrl != null && resourceUrl != ''){
            window.open(resourceUrl,'_blank');
        } else {
            $('#download-format').val(format);
            $('#download_resource_form').attr('action', downloadUrl + '/'+ resourceId);
            $('#download_resource_form').submit();
        } 
    }	
	
	var getBinaryFile = function(id){
		navigateUrl('/controlpanel/files/' + id );
	}
	
	var copyToClipboard = function(url){
		var context = window.location.href.split(window.location.pathname)[0];
		var $temp = $("<input />");
		$("body").append($temp);
		$temp.val(context + url).select();
		document.execCommand("copy");
		$temp.remove();
		
	}
    
	// MAIN WHEN READY
	$( document ).ready(function() {
		// init when Document is ready
		showLog ? console.log('SHOW Dataset ready()...') : '';
	});
	 
	// MAIN WHEN LOAD
	$(window).load(function(){ 
		var dataTable = $('#resources').dataTable({
          "bAutoWidth": false
          });
		var oTable = $('#files').DataTable({
          "bAutoWidth": false
          });

		var offsetTop = 0;
		var offsetLeft = 0;
		// init on load.		
		showLog ? console.log('SHOW Dataset load()...') : '';

		$('.dataTables_info').addClass('col-md-6 col-sm-6');
        $('.dataTables_length').addClass('col-md-6 col-sm-6');
        $('#resources_wrapper > div:nth-child(3)').addClass('table-scrollable table-scrollable-borderless');
        $('#resources_wrapper > div:nth-child(3) > div.col-md-5.col-sm-5').append($('#resources_length'));
        $('#files_wrapper > div:nth-child(3)').addClass('table-scrollable table-scrollable-borderless');
        $('#files_wrapper > div:nth-child(3) > div.col-md-5.col-sm-5').append($('#files_length'));

        $('#resources-search-on-title').append($('#resources_filter > label > input'));
        $('#resources-search-on-title > input').removeClass('input-xsmall')
        $('#resources_wrapper > div:nth-child(1)').hide();
        $('#files-search-on-title').append($('#files_filter > label > input'));
        $('#files-search-on-title > input').removeClass('input-xsmall')
        $('#files_wrapper > div:nth-child(1)').hide();

        $('#resources_paginate').attr('style', 'float:right !important');
        $('#files_paginate').attr('style', 'float:right !important');
        $('.download-menu-options').parent().on('shown.bs.dropdown', function () {	        
			 var $menu = $("ul.download-menu-options", this);	        
	         offset = $menu.offset();
	         $('body').append($menu);
	         $menu.show();
	         $menu.css('position', 'absolute');
	         $menu.css('top', (offset.top) +'px');
	         offsetTop = offset.top;
	         $menu.css('left',(offset.left) +'px');
	         offsetLeft = offset.left;
	         $menu.css('min-width', '100px');
	        $(this).data("myDropdownMenu", $menu);
	     });
		$('.download-menu-options').parent().on('hide.bs.dropdown', function () {
	         $(this).append($(this).data("myDropdownMenu"));
	         $(this).data("myDropdownMenu").removeAttr('style');
	     });

        $('.download-menu-download').parent().on('shown.bs.dropdown', function (e) {
        	e.stopPropagation();
        	var $menu = $("ul.download-menu-download", this);
        	if (document.getElementById("options-dropdown") === null) {
        		var downloadButton = $(".downloadBtn2");
        		offset = $menu.offset();
        		$('body').append($menu);
			    $menu.show();
			    $menu.css('position', 'absolute');
        		$menu.css('top', (offset.top) + 'px');
		    	$menu.css('left', (downloadButton.offset().left) + 'px');
        	} else {
        		$('body').append($menu);
			    $menu.show();
			    $menu.css('position', 'absolute');
        		$menu.css('top', offsetTop + 'px');
		    	$menu.css('left', offsetLeft + 'px');
        	}
		    $menu.css('min-width', '100px');
		    $(this).data("myDropdownMenu", $menu);
		});
		$('.download-menu-download').parent().on('hide.bs.dropdown', function () {
		    $(this).append($(this).data("myDropdownMenu"));
		    $(this).data("myDropdownMenu").removeAttr('style');
		});
		$("button[title|='Preview']").click();
	});
	
	//]]>
	</script>		

</body>
</html>