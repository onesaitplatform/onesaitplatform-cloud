<!--

    Copyright Indra Soluciones Tecnologías de la Información, S.L.U.
    2013-2023 SPAIN

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
         http://www.apache.org/licenses/LICENSE-2.0
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<html xmlns:th="http://www.thymeleaf.org" xmlns:dt="http://www.thymeleaf.org/dandelion/datatables" th:with="lang=${#locale.language}" th:lang="${lang}">

	<head>
		<meta name="_csrf" th:content="${_csrf.token}"/>
		<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
		<meta http-equiv="Content-Language" th:content="${lang}"/>
		<title th:text="#{name.app}"/>
		
	
		<!-- STYLE SHEETS -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/bootstrap.min.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/components.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/plugins.css}"/>
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/css/layout.css}"/>
		<!-- THEME -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/webjars/sofia2_theme/css/sofia2.css}"/>
		
		<!-- PLUGINS STYLE SHEETS, BOOSTRAP-SELECT -->
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/datatable/datatables.bootstrap.css}"/>	
		<link rel="stylesheet" type="text/css" media="all" th:href="@{/static/vendor/bootstrap-select/bootstrap-select.min.css}"/>
		
	</head>	
	
	<!-- page-sidebar-closed to start page with collapsed menu -->
	<body class="page-header-fixed  page-content-white page-sidebar-closed">

	<!-- MAIN PAGE WRAPPER -->
	<div class="page-wrapper">
	
		<!-- BEGIN HEADER INCLUDE -->
		<div th:include="fragments/header::#headerFragment" class="page-header navbar navbar-fixed-top"></div>
		<!-- END HEADER -->
		
		<!-- BEGIN HEADER AND CONTENT DIVIDER -->
		<div class="clearfix"> </div>		
			
		<!-- BEGIN SIDEBAR -->
		<div th:include="fragments/menu::#menuFragment" class="page-sidebar-wrapper"></div>
		<!-- END SIDEBAR -->
		
		<!-- BEGIN CONTENT -->
		<div class="page-content-wrapper">
			
			<!-- BEGIN CONTENT BODY -->
			<div class="page-content">
				
				<!-- BEGIN PAGE HEADER-->
				
				<!-- BEGIN PAGE BAR AND BREADCRUM -->
				<div class="page-bar margin-bottom-20">
					<ul class="page-breadcrumb">
						<li><a th:href="@{/}">Home</a><i class="fa fa-angle-right"></i></li>						
						<li><a th:href="@{/opendata/resources/list}"> <span th:text="#{resources.breadcrumb.list}">Resources</span></a><i class="fa fa-angle-right"></i> </li>
						<li><span th:text="#{resources.breadcrumb.show}">Show Resource</span></li>
					</ul>						
				</div>
				<!-- END PAGE BAR -->
				
				<!-- BEGIN PAGE TITLE-->
				<h1 class="page-title hide "><span th:text="#{name.app}"> Onesaitplatform Control Panel</span></h1>
				<!-- END PAGE TITLE-->			
				
				<!-- AUXILIAR FORM TO DELETE RESOURCE -->										
				<form id="delete_resource_form" class="delete-resource hide"  action=""  method="post">
					<input type="hidden" name="_method" value="DELETE"/>
					<input type="hidden" name="id" th:value="${resource?.id}"/>
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
				</form>
				
				<form role="form" id="resource_view_form" th:object="${resource}" method="post" class="form">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
					<div id="header">
						<div class="row pageCreateHeader">
							<div class="col-md-6 col-sm-6 col-xs-12">
								<div class="margin-top-4">
									<span class="caption-subject " th:text="${resource.name}"> Show Resource</span>
								</div>
							</div>
							
							<div class="col-md-6 col-sm-6 col-xs-12">
								<div class="pull-right">
									<!-- DELETE -->
									<button th:if="${resource.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" id="deleteBtn" type="button" class="btn btn-primary btn-primary-delete" name="delete"  value="Remove" th:attr="onclick='deleteResourceConfirmation(\'' + ${resource.id} + '\');'" ><i class="icon-delete"></i><span th:text="#{gen.deleteBtn}" class="delete-btn-text"> Delete </span></button>
									<span th:if="${resource.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" class="sep"></span>	
										
									<!-- CANCEL -->											
									<button	id="cancelBtn" type="button"	class="btn btn-primary-cancel" name="cancel" th:value="#{gen.cancelBtn}" value="cancel" th:attr="onclick='javascript:navigateUrl(\'' + @{/opendata/resources/list} + '\');'"><span th:text="#{gen.cancelBtn}"> Cancel </span></button>	
									<span th:if="${resource.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" class="sep no-border"></span>
	
									<!-- UPDATE -->								
									<button th:if="${resource.id} != null AND ((${#strings.arrayJoin(#authentication.authorities,'')} == 'ROLE_ADMINISTRATOR') OR ${modifyPermissions})" id="editBtn" type="button" class="btn btn-primary btn-primary-save" name="edit"  value="Edit" th:attr="onclick='javascript:navigateUrl(\'' + @{|/opendata/resources/updatePlatformResource/${resource.id}/|} + '\');'" > <span th:text="#{gen.editBtn}"> Edit </span></button>
	
								</div>
							</div>
						</div>
					</div>
					<div class="mainPanel">	
						<div class="row main">
						    <div class="col-md-12 panelHeader">
						        <span th:text="#{gen.generalInformation}">General Information</span>
						    </div>			
           				</div>
           				<div class="row main">											
           					<div class="col-md-4 col-sm-12 col-xs-12">
								<div class="form-group">
									<label class="control-label" th:text="#{resources.name} ">Name</label>
									<p id="viewName" name="viewName" class="form-control-static-block " th:text="*{name}"> Resource Name </p>
								</div>
							</div>
							<div class="col-md-4 col-sm-12 col-xs-12" id="div-dataset">
								<div class="form-group">	
									<label class="control-label" th:text="#{resources.dataset} ">Dataset</label>
									<p id="viewDataset" name="viewDataset" class="form-control-static-block " th:text="*{dataset}"> Resource Dataset </p>
								</div>
							</div>
							<div class="col-md-3 col-sm-12 col-xs-12">
								<div class="form-group">	
									<label class="control-label"><span th:text="#{resources.format} ">Format</span></label>
									<p class="form-control-static-block " th:text="*{format}"> Resource format </p>
								</div>
							</div>
           				
           				</div>
          				<div th:if="${resource.description != null AND resource.description != ''}" class="row main">
							<div class="col-md-6 col-sm-12 col-xs-12">
								<div class="form-group">	
									<label class="control-label"><span th:text="#{resources.description} ">Description</span></label>
									<p class="form-control-static-block " th:text="*{description}"> Resource description </p>
								</div>
							</div>
						</div>
						<div class="row main">
							<div class="col-md-3 col-sm-12 col-xs-12 hide" id="div-resource">
								<div class="form-group">	
									<label class="control-label" th:text="#{resources.platform.resource} "> Platform Resource </label>
									<p id="viewPlatformResource" name="viewPlatformResource" class="form-control-static-block " th:text="${#strings.capitalize(resource.platformResource)}"> Platform Resource </p>
								</div>
							</div>
							<div id="dashboard-div" class="col-md-6 col-sm-12 col-xs-12 hide">
								<div class="form-group">
									<label class="control-label" th:text="#{resources.platform.dashboard} ">Dashboards</label>
									<p id="viewDashboard" name="viewDashboard" class="form-control-static-block " th:text="*{dashboardId}"> Dashboard </p>
								</div>
							</div>
							<div id="viewer-div" class="col-md-6 col-sm-12 col-xs-12 hide">
								<div class="form-group">
									<label class="control-label" th:text="#{resources.platform.viewer} "> GIS Viewers</label>
									<p id="viewViewer" name="viewViewer" class="form-control-static-block " th:text="*{viewerId}"> Viewer </p>
								</div>
							</div>
							<div id="api-div" class="col-md-6 col-sm-12 col-xs-12 hide">
								<div class="form-group">
									<label class="control-label" th:text="#{resources.platform.api} "> Apis </label>
									<p id="viewApi" name="viewApi" class="form-control-static-block " th:text="*{apiId}"> Api </p>
								</div>
							</div>
							<div id="public-div" class="col-md-3 col-sm-12 col-xs-12 hide">
								<label class="control-label" th:text="#{resources.public.title} + '?'">Public</label>
									<p class="form-control-static-block static-blank ">
										<span th:if="*{platformResourcePublic}"><i class="la la-check-circle-o text-success font-hg"></i></span>
										<span th:if="!*{platformResourcePublic}"><i class="la la-times-circle-o text-danger font-hg"></i></span>
									</p>
							</div>
						</div>
           			</div>
				</form>		
			</div><!-- END CONTENT BODY -->
		</div><!-- END CONTENT page-content-wrapper -->		
	</div>
	<!-- END MAIN PAGE WRAPPER -->
	
	<!-- FOOTER-INCLUDE -->
	<footer th:include="fragments/footer::#footerFragment" class="page-footer"> </footer>	

	<!-- BLOCKUI -->
	<script th:src="@{/static/vendor/blockUI.js}"></script>
	
	<!-- CORE CONTROLLERS -->
	<script th:src="@{/static/js/app.js}"></script>
	<script th:src="@{/static/js/layout.js}"></script>
	
	<!-- PLUGINS -->
	<script th:src="@{/static/vendor/bootstrap-select/bootstrap-select.min.js}"></script>


	<script th:inline="javascript">
	/* <![CDATA[ */

		var platformResource = [[${resource.platformResource}]];

		// REDIRECT
		function navigateUrl(url){  window.location.href = url;	}

		// DELETE Resource 
		function deleteResourceConfirmation(resourceId){
			console.log('deleteResourceConfirmation() -> formId: '+ resourceId);
			
			
			// set action and resourceId to the form
			$('.delete-resource').attr('id',resourceId);
			$('.delete-resource').attr('action','/controlpanel/opendata/resources/delete/' + resourceId);
			console.log('deleteResourceConfirmation() -> formAction: ' + $('.delete-resource').attr('action') + ' ID: ' + $('.delete-resource').attr('id'));
			
			// call Resource Confirm at header.
			HeaderController.showResourceConfirmDialog(resourceId);	
		}	

		$(window).on("load",function(){
			if (platformResource != null){
				var divElement = '#' + platformResource + '-div';
				$(divElement).removeClass('hide');
				$('#public-div').removeClass('hide');
				$('#div-resource').removeClass('hide');
			}		
		});

	/* ]]> */
	</script>
	
</body>
</html> 

  