/* MounTable.js | Developed by Guilherme Augusto Madaleno <guimadaleno@me.com> | www.guimadaleno.com | (C) 2014 All rights reserved | Licensed under GNU GPL */
$.fn.mounTable=function(e,n){var t={debug:n&&n.noDebug?!1:!0,fn:{element:"",model:{"class":n&&n.model?n.model:".mountable-model",content:"",length:Object.keys($(this).find(n&&n.model?n.model:".mountable-model")).length,newLine:n&&n.addLine&&n.addLine.button?n.addLine.button:".mountable-new-line",origin:"",saved:""},table:this}},l={init:function(){e&&$.isNumeric(e.length)&&($(t.fn.table).length?$.each(e,function(e,n){n&&($.each(n,function(e,n){"string"===$.type(n)||"number"===$.type(n)?(t.fn.element=$(t.fn.table).find(t.fn.model.class).find('input[name="'+e+'[]"], input[name="'+e+'"], select[name="'+e+'[]"], select[name="'+e+'"]'),"INPUT"==t.fn.element.prop("tagName")?"text"==t.fn.element.attr("type")||"number"==t.fn.element.attr("type")?t.fn.element.attr("value",n):"checkbox"==t.fn.element.attr("type")&&t.fn.element.length>1&&$.each(t.fn.element,function(e,t){t.value==n?t.setAttribute("checked","checked"):t.removeAttribute("checked")}):"SELECT"==t.fn.element.prop("tagName")&&(t.fn.element.val(n),t.fn.element.children("option").attr("selected",!1),t.fn.element.children('option[value="'+n+'"]').attr("selected","selected"))):"array"===$.type(n)&&(t.fn.element=$(t.fn.table).find(t.fn.model.class).find('select[name="'+e+'[]"], select[name="'+e+'"]'),"SELECT"==t.fn.element.prop("tagName")&&(selectOpts=!1,$.each(n,function(e,n){selectOpts+='<option value="'+n+'">'+n+"</option>"}),t.fn.element.html(selectOpts),t.fn.element.attr("data-mountable-filled-up-selectbox","yes")))}),t.fn.model.dom=$(t.fn.table).find(t.fn.model.class),t.fn.model.content=$(t.fn.table).find(t.fn.model.class).html(),$(t.fn.table).find(t.fn.model.class).parent().append("<tr>"+t.fn.model.content+"</tr>"),$(t.fn.table).find(t.fn.model.class+" input").each(function(){"text"==$(this).prop("type")||"number"==$(this).prop("type")?$(this).attr("value",""):"checkbox"==$(this).prop("type")&&$(this).each(function(){$(this).attr("checked",!1)})}),$(t.fn.table).find(t.fn.model.class+" select").each(function(){$(this).find("option").each(function(){$(this).removeAttr("selected")}),$(this).attr("value",""),"yes"==$(this).attr("data-mountable-filled-up-selectbox")&&$(this).html(" ")}))}):t.debug&&console.log("MounTable: Table "+t.fn.table.selector+" not found!"),t.fn.model.saved="<tr>"+$(t.fn.table).find(t.fn.model.class).html()+"</tr>",t.fn.model.origin=$(t.fn.table).find(t.fn.model.class).parent(),t.debug&&console.log("MounTable: content successfully mounted on "+t.fn.table.selector),$(t.fn.model.newLine).off("click").on("click",function(){n.addLine.onClick&&"function"===$.type(n.addLine.onClick)&&n.addLine.onClick($(t.fn.table).find(t.fn.model.class))===!0&&(t.fn.model.origin.append(t.fn.model.saved),l.deleteLine())}),l.deleteLine(),$(t.fn.table).find(t.fn.model.class).remove())},deleteLine:function(){n&&n.deleteLine&&n.deleteLine.button&&$(n.deleteLine.button).off("click").on("click",function(){n.deleteLine.onClick&&"function"===$.type(n.deleteLine.onClick)?n.deleteLine.onClick($(this).parent().parent())===!0&&$(this).parent().parent().remove():$(this).parent().parent().remove()})}};l.init()};